---
copyright:
  years: 2016,2018
lastupdated: "2018-06-13"
---

{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}
{:tip: .tip}

# アーキテクチャー 
{: #architecture}

## 複製

{{site.data.keyword.composeForRabbitMQ_full}} サービスには 3 つのノードがあり、それらが一体として高可用性ブローカーの働きをします。各ノードは RabbitMQ アプリケーションを実行し、ユーザー、仮想ホスト、キュー、交換、バインディング、ランタイム・パラメーターを共有します。 サービスがデプロイされる領域を選択すると、3 つのノードはその領域のアベイラビリティー・ゾーンに分散され、RabbitMQ ブローカーの操作に必要なすべてのデータと状態がすべてのノードに複製されます。 

1 つのノードがマスターとして機能し、その他のノードはミラーとして機能します。 ミラーは、マスターに対して行われる操作をマスターとまったく同じ順序で適用することにより、同じ状態を維持します。 パブリッシュ・アクション以外のすべてのアクションはマスターのみに対して実行され、その後マスターはアクションの効果をミラーにブロードキャストします。 マスターに障害が起こると、ミラーの 1 つがプロモートされ、RabbitMQ ブローカーは正常に機能します。

## ディスクの暗号化

すべての {{site.data.keyword.composeForRabbitMQ}} サービスには、保存時の暗号化機能があります。 データは、ボリューム・レベルの暗号化が有効になっているサーバー上に配置されます。 

{{site.data.keyword.composeForRabbitMQ}} はマネージド・サービスであるので、{{site.data.keyword.cloud}} Compose のオペレーターはデータを見ることができます。 ディスクの暗号化に加えて、メッセージング・キューで個人情報を渡す場合には、情報を暗号化してから送信するか、RabbitMQ 自体に対して暗号化を有効にする拡張機能または機能を使用することをお勧めします。 これらの方法は使いやすさやパフォーマンスに影響することがありますが、個人情報を暗号化で保護するのは良い習慣です。


## 自動スケーリング

リソースは、RabbitMQ ブローカーの合計メモリー使用量に基づいて自動的にスケーリングされます。 ストレージは、プロビジョンされる RAM との比率が 1:1 になるように調整されます。 これらのリソースはユニットとしてバンドルされます。

自動スケーリングは、データベースの短期間から中期間のトレンドに対応するように設計されています。 サービスは 1 分ごとに検査され、RAM が不足している場合は、追加のユニットがデプロイメントに割り振られます。 

自動スケーリングにより、ディスク/メモリー使用量が縮小したデプロイメントのスケールが縮小されることはありません。 データベースにプロビジョンされたリソースは、将来の必要に備えて、手動でデプロイメントを縮小しない限り保持されます。
{: .tip}
